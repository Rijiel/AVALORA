@using AutoMapper
@model CartItemResponsesVM
@inject IMapper mapper
@{
	ViewData["Title"] = $"Cart({Model.CartItemResponses.Count()})";
}

<div class="mt-5">
	<div class="text-center">
		<h3 class="text-uppercase">Shopping Cart</h3>
	</div>

	<div class="row mt-5">
		<div class="col-12">
			<div>
				<a asp-controller="Home" asp-action="Index" class="btn btn-outline-info">Continue shopping</a>
			</div>
			@foreach (var cartItem in Model.CartItemResponses)
			{
				<div class="row mt-4">
					<!-- Product Details -->
					<div class="col-7">
						<div class="row">
							<div class="col-2">
								<partial name="_ProductImagePartial" model="mapper.Map<ProductResponse>(cartItem.Product)" />
							</div>
							<div class="col-10 mt-2">
								<h3 class="fs-4">@cartItem.Product.Name</h3>
								<div class="overflow-auto" style="max-height: 10rem">
									<p><small>@Html.Raw(cartItem.Product.Description)</small></p>
								</div>
							</div>
						</div>
					</div>
					<!-- Price, Quantity -->
					<div class="col-2 text-center fw-bold">
						<div>@cartItem.Product.Price.ToString("c")</div>
						<div>
							x <span>@cartItem.Count</span>
						</div>
					</div>
					<!-- Count Buttons -->
					<div class="col-2 text-center">
						<div class="btn-group">
							<a asp-action="Subtract" asp-route-id="@cartItem.Id" class="btn btn-outline-primary me-1 w-50 px-4">
								<span class="fw-bold">-</span>
							</a>
							<a asp-action="Add" asp-route-id="@cartItem.Id" class="btn btn-outline-primary w-50 px-4">
								<span class="fw-bold">+</span>
							</a>
						</div>
					</div>
					<!-- Delete Button -->
					<div class="col-1 text-center">
						<a asp-action="Remove" asp-route-id="@cartItem.Id" class="btn btn-danger"><i class="bi bi-trash3"></i></a>
					</div>
				</div>
				<hr />
			}
			<!-- Total Price -->
			<div class="text-center fw-bold fs-5">
				<span class="mx-3">TOTAL (USD)</span>
				<span class="mx-3">@Model.TotalPrice.ToString("c")</span>
			</div>
			<!-- Button -->
			<div class="text-center mt-4">
				<a asp-action="Checkout" class="btn btn-primary">Checkout</a>
			</div>
		</div>
	</div>
</div>
